\subsubsection{Particles motion}

In this stage, all particles are updated.

\[
\begin{split}
&\vec{p_i} = \vec{p_i} + \overrightarrow{hv_i} \cdot \Delta t + \vec{a_i} \cdot (\Delta t)^2\\
&\vec{v_i} = \overrightarrow{hv_i} + \frac{\vec{a_i} \cdot \Delta t}{2}\\
&\overrightarrow{hv_i} = \overrightarrow{hv_i} + \vec{a_i} \cdot \Delta t
\end{split}
\]
